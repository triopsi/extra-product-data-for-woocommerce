(()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,o(i.key),i)}}function o(t){var o=function(t,o){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,o||"default");if("object"!=e(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===o?String:Number)(t)}(t,"string");return"symbol"==e(o)?o:o+""}jQuery(function(e){new(function(){return o=function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.$orderItemsContainer=e("#woocommerce-order-items"),this.modalView=null,this.initialize()},(n=[{key:"initialize",value:function(){this.setupEventHandlers()}},{key:"setupEventHandlers",value:function(){this.$orderItemsContainer.on("click","button.exprdawc_edit_addons",{action:"edit"},this.handleEditButtonClick.bind(this))}},{key:"handleEditButtonClick",value:function(t){t.preventDefault();var o=e.WCBackboneModal.View.extend({addButton:this.handleDoneButtonClick.bind(this)}),n=e(t.currentTarget).closest("tr.item").attr("data-order_item_id");return this.modalView=new o({target:"wc-modal-edit-exprdawc",string:{action:wc_exprdawc_admin_order_params.i18n_edit,item_id:n}}),this.populateModalForm(),!1}},{key:"populateModalForm",value:function(){var t=this;this.blockUI(this.modalView.$el.find(".wc-backbone-modal-content"));var o={action:"woocommerce_configure_exprdawc_order_item",item_id:this.modalView._string.item_id,dataType:"json",order_id:woocommerce_admin_meta_boxes.post_id,security:wc_exprdawc_admin_order_params.edit_exprdawc_nonce};e.post(woocommerce_admin_meta_boxes.ajax_url,o,function(e){e.data&&e.success?(t.modalView.$el.find("form").html(e.data.html),t.unblockUI(t.modalView.$el.find(".wc-backbone-modal-content"))):(window.alert(wc_exprdawc_admin_order_params.i18n_form_error),t.unblockUI(t.modalView.$el.find(".wc-backbone-modal-content")),t.modalView.$el.find(".modal-close").trigger("click"))})}},{key:"handleDoneButtonClick",value:function(t){var o=this,n=e.extend({},{action:"woocommerce_edit_exprdawc_order_item",item_id:this.modalView._string.item_id,dataType:"json",order_id:woocommerce_admin_meta_boxes.post_id,security:wc_exprdawc_admin_order_params.edit_exprdawc_nonce}),i=this.modalView.$el.find("form")[0];if(!0===i.reportValidity()){var r=new FormData(i);for(var a in n)r.append(a,n[a]);this.blockUI(this.modalView.$el.find(".wc-backbone-modal-content")),e.post({url:woocommerce_admin_meta_boxes.ajax_url,type:"POST",data:r,processData:!1,contentType:!1,cache:!1,success:function(n){n.data&&n.success?(o.$orderItemsContainer.find(".inside").empty(),o.$orderItemsContainer.find(".inside").append(n.data.html),o.$orderItemsContainer.trigger("wc_order_items_reloaded"),n.data.notes_html&&(e("ul.order_notes").empty(),e("ul.order_notes").append(e(n.data.notes_html).find("li"))),o.unblockUI(o.modalView.$el.find(".wc-backbone-modal-content")),o.blockUI(o.$orderItemsContainer,{fadeIn:0}),setTimeout(function(){o.unblockUI(o.$orderItemsContainer)},250),o.modalView.closeButton(t)):(window.alert(n.data.message),o.unblockUI(o.modalView.$el.find(".wc-backbone-modal-content")))},error:function(){window.alert(wc_exprdawc_admin_order_params.i18n_validation_error),o.unblockUI(o.modalView.$el.find(".wc-backbone-modal-content"))}})}}},{key:"blockUI",value:function(t,o){var n=e.extend({},{message:null,overlayCSS:{background:"#fff",opacity:.6}},o||{});t.block(n)}},{key:"unblockUI",value:function(e){e.unblock()}}])&&t(o.prototype,n),i&&t(o,i),Object.defineProperty(o,"prototype",{writable:!1}),o;var o,n,i}())})})();